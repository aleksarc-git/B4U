<h1>Listing products</h1>

<div class="user_session">
  <ul>
    <li>
      <% if user_signed_in? %>
        <%= link_to('Logout', destroy_user_session_path, method: :delete) %>
    </li>
    <% end %>
      </li>
      <li>
        <% if user_signed_in? %>
          <%= current_user.email %>
            <% end %>
      </li>
  </ul>
</div>

<div class="col">
  <table>
    <thead>
      <tr>
        <th>Preview</th>
        <th>Name</th>
        <th>Description</th>
        <th>Price</th>
        <th>Quantity</th>
        <th>Category</th>
        <th colspan="3"></th>
      </tr>
    </thead>

    <tbody>
      <% @products.each do |product| %>
        <tr>
          <td><%= link_to (image_tag product.image, :style => "height:100px"), product %></td>
          <td><%= product.name %></td>
          <td><%= product.description %></td>
          <td><%= product.price %></td>
          <td><%= product.quantity %></td>
          <td><%= product.category %></td>
          <td><%= link_to 'Show', product %></td>
          <% if current_user && current_user.admin? %>
            <td><%= link_to 'Edit', edit_product_path(product) %></td>
            <td><%= link_to 'Destroy', product, method: :delete, data: { confirm: 'Are you sure?' } %></td>
          <% else %>
            <td><a href="/cart/<%= product.id %>"> Add to Cart</a></td>
          <% end %>
        </tr>
        <% end %>
    </tbody>
  </table>
</div>
<div class="bottom-links">
  <ul>
    <li>
      <% if current_user && current_user.admin? %>
        <%= link_to 'New Product', new_product_path %>
          <% end %>
    </li>
    <li>
      <%= link_to 'Go to cart', cart_index_path %>
    </li>
    <li>
      <%= link_to 'Home', root_path %>
    </li>
  </ul>
</div>